<!DOCTYPE HTML>
<html>
	<head>
		<title>Data Analytics Portfolio</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	<style>
        .explanation {
            display: none; /* Αρχικά κρυφό */
        }

        .explanation.visible {
            display: block;
        }

	table {
        width: 100%;
        border-collapse: collapse; /* Εξάλειψη περιθωρίων μεταξύ κελιών */
    }

    th, td {
        border: 1px solid black; /* Πρόσθεση περιγράμματος */
        padding: 8px; /* Απόσταση γύρω από το κείμενο */
        text-align: center; /* Στοίχιση κειμένου στο κέντρο */
    }


   /* Στυλ για το κουμπί */
        #scrollTopBtn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            display: none; /* Αρχικά κρυφό */
            align-items: center;
            justify-content: center;
            transition: 0.3s ease-in-out;
        }

        /* Hover effect */
        #scrollTopBtn:hover {
            background-color: #0056b3;
        }

        /* Animation για smooth εμφάνιση */
        #scrollTopBtn.show {
            display: flex;
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }	



		
    </style>


		
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">


				<!-- Header -->
					<header id="header" class="alt">
						<a href="index.html" class="logo"><strong>Data Analytics</strong> <span>Portfolio</span></a>
						<nav>
							<a href="#menu">Menu</a>
						</nav>
					</header>

				<!-- Menu -->
					<nav id="menu">
					    <ul class="links">
					        <li><a href="index.html">Home</a></li>
					        <li><a href="index.html#one">About Me</a></li>
					        <li><a href="index.html#two">Projects</a></li>
					        <li><a href="index.html#footer">Contact</a></li>
					    </ul>
					</nav>

				<!-- Main -->
					<div id="main" class="alt">

						<!-- One -->
							<section id="one">
								<div class="inner">
									<header class="major">
										<h1>Project 1</h1>
										<h2>Earthquake Monitoring and Analysis in Greece: SQL Analysis</h2>
									</header>
								
									<span class="image main">
									<img src="images/A_realistic_digital_illustration_of_a_seismograph__converted.png" alt="Temp Text" style="max-width: 700px; height: auto;" /></span>

<p style="height: 1500px;">Κάνε scroll κάτω για να δεις το κουμπί!</p>

    <!-- Κουμπί για scroll to top -->
    <button id="scrollTopBtn" onclick="scrollToTop()">↑</button>
									
								
									<h3> The Opportunity:</h3>
									<p> This project focuses on analyzing earthquake activity in Greece using real earthquake data recorded from 01/01/2022 to 14/02/2025. 
									The goal is to store, clean, analyze, and derive meaningful insights from the data, using SQL Server for data management and querying.</p>
								
								
									<h4>What is an Earthquake?</h4>

										<p>An earthquake is the shaking of the ground caused by the rupture of rocks, which is the result of a long-term process of accumulating dynamic energy in stressed areas of the lithosphere.

										An earthquake occurs when the mechanical equilibrium of rocks is disturbed by natural causes related to the Earth's interior.

										How do we measure earthquakes?

										To compare earthquakes, a measure of their strength was needed. Thus, the Magnitude (M) of an earthquake was defined, which represents the amount of energy released from the focus during earthquake activity.

										Magnitude is determined by measuring various parameters of earthquake waves, such as amplitude, period, and duration.

										Several magnitude scales have been devised for this purpose. The most well-known is the local magnitude scale (ML), also known as the Richter scale.

										The largest earthquake ever recorded globally had a magnitude of 9.5 (Chile, 22-5-1960).
										Source:<a href="url">https://oasp.gr</a></p>
										
								
									<h4>Data Source</h4>
										<p>The earthquake data used in this analysis were obtained from the National Observatory of Athens - Geodynamic Institute. 
										The data were extracted from their official database, accessible at: Geodynamic Institute Search Database.</p>
										
								
								
									<h4>Data Extraction and Loading</h4>
									<p>The earthquake data were collected from reliable sources and imported into SQL Server. The dataset includes attributes such as:</p>
										<ul>
										<li><p>Origin Time (GMT)</p></li>

										<li><p>Latitude & Longitude</p></li>

										<li><p>Depth (km)</p></li>

										<li><p>Magnitude (ML)</p></li>

										<li><p>Location & Region</p></li>
										</ul>
										
										<p>A Data Warehouse structure was designed to efficiently store and analyze the data.</p>

								            
				
									<h4>Data Cleaning & Modelling</h4>
									<h4>During data processing:</h4>
										<ul>
										<li><p>Null values were replaced where applicable.</p></li>

										<li><p>Data types were standardized.</p></li>

										<li><p>Fact and Dimension tables were created to optimize querying performance.</p></li>
										</ul>


									<h4> Key Insights </h4>
									<h4> 1. Earthquake Activity by Region </h4>
											<ul>
												<!--<li><p> Identified the regions with the highest number of recorded earthquakes.</p></li>-->
													
												
												<button class="toggle-query-button" onclick="toggleQuery('query1')"><li><p> Identified the regions with the highest number of recorded earthquakes.</p></li></button>

												
												<div id="query1" class="query-container">
<pre>
<code>
SELECT TOP 5 r.Region_name, 
	     max(e.location) as Location,
             COUNT(e.[Magnitude (ML)]) AS [Total Earthquakes]
FROM Earthquakes_Data e
JOIN Region_Dim r ON e.region_name = r.region_name
WHERE YEAR(e.[Origin Time (GMT)]) = YEAR(GETDATE())
GROUP BY r.region_name
ORDER BY [Total Earthquakes] DESC;
</code>
</pre>
													

											<h3>Sample Results</h3>
											<table border="1">
											<tr>
											<th>Region_Name </th>
											<th>Location</th>
											<th>Total Earthquakes</th>
											</tr>
											<tr>
											<td>Thira</td>
											<td>9.0 km WSW of Thira</td>
											<td>1688</td>
											</tr>
											<tr>
											<td>Pyrgos</td>
											<td>60.5 km SSW of Pyrgos</td>
											<td>578</td>
											</tr>
											<tr>
											<td>Aegion</td>
											<td>9.9 km SSW of Aegion</td>
											<td>222</td>
											</tr>
											<tr>
											<td>Kariai</td>
											<td>9.9 km WNW of Kariai</td>
											<td>164</td>
											</tr>
											<tr>
											<td>Zakynthos</td>
											<td>90.2 km SW of Zakynthos</td>
											<td>149</td>
											</tr>
											</table>
											</div>

												
											<button class="toggle-query-button" onclick="toggleQuery('query2')"><li><p> Determined the regions with the most high-magnitude (>4.5) earthquakes.</p></li></button>

											
												<div id="query2" class="query-container">
<pre>
<code>
SELECT	r.region_name,
	max(e.location) as Location,
	max(e.[Magnitude (ML)]) as [Highest-magnitude]
FROM Earthquakes_Data e
JOIN Region_Dim r ON e.region_name = r.region_name
WHERE e.[Magnitude (ML)] > 4.5
AND YEAR(e.[Origin Time (GMT)]) = YEAR(GETDATE())
GROUP BY r.region_name
ORDER BY r.region_name desc;
</code>
</pre>
	
											<h3>Sample Results</h3>
											<table border="1" >
											<tr>
											<th>Region_Name</th>
											<th>Location</th>
											<th>Highest-magnitude</th>
											</tr>
											<tr>
											<td>Thira</td>
											<td>39.5 km NE of Thira</td>
											<td>5.2</td>
											</tr>
											<tr>
											<td>Pyrgos</td>
											<td>37.9 km SSE of Pyrgos</td>
											<td>4.6</td>
											</tr>
											<tr>
											<td>Mitilini</td>
											<td>27.0 km N of Mitilini</td>
											<td>5.1</td>
											</tr>
											<tr>
											<td>Kariai</td>
											<td>12.8 km WNW of Kariai</td>
											<td>4.7</td>
											</tr>
											</table>
											</div>

												
									<h4>2. Strongest Earthquakes Analysis</h4>
											    <ul>
												    <button class="toggle-query-button" onclick="toggleQuery('query3')"><li><p> Found the strongest earthquake recorded per region.</p></li></button>
												
												<div id="query3" class="query-container">
<pre>
<code>
SELECT r.region_name, 
       [Origin Time (GMT)],
       [Location],
       MAX(e.[Magnitude (ML)]) AS max_magnitude
FROM Earthquakes_Data e
JOIN Region_Dim r ON e.region_name = r.region_name
WHERE YEAR(e.[Origin Time (GMT)])  between 2022 and 2025
GROUP BY r.region_name,
	 [Origin Time (GMT)],
	 [Location]
ORDER BY max_magnitude DESC;
</code>
</pre>
											<h3>Sample Results</h3>
											<table border="1">
											<tr>
											<th>Region_Name</th>
											<th>Location</th>
											<th>Origin Time (GMT)</th>
											<th>Magnitude (ML)</th>
											</tr>												
											<tr>
											    <td>Rodhos</td>
											    <td>79.8 km SSE of Rodhos</td>
											    <td>2023-01-25 12:37:06.000</td>
											    <td>5.9</td>
											</tr>
											<tr>
											    <td>Pyrgos</td>
											    <td>57.3 km SSW of Pyrgos</td>
											    <td>2024-03-29 07:12:48.000</td>
											    <td>5.8</td>
											</tr>
											<tr>
											    <td>Karpathos</td>
											    <td>63.8 km WNW of Karpathos</td>
											    <td>2022-11-20 23:25:01.000</td>
											    <td>5.5</td>
											</tr>
											<tr>
											    <td>Kariai</td>
											    <td>29.7 km S of Kariai</td>
											    <td>2022-01-16 11:48:05.000</td>
											    <td>5.4</td>
											</tr>
											<tr>
											    <td>Argostoli</td>
											    <td>60.9 km WSW of Argostoli</td>
											    <td>2022-09-08 07:36:20.000</td>
											    <td>5.4</td>
											</tr>
											<tr>
											    <td>Chania</td>
											    <td>105.3 km SW of Chania</td>
											    <td>2024-07-21 04:01:29.000</td>
											    <td>5.3</td>
											</tr>
											<tr>
											    <td>Florina</td>
											    <td>1.5 km WSW of Florina</td>
											    <td>2022-01-09 21:43:47.000</td>
											    <td>5.3</td>
											</tr>
											<tr>
											    <td>Kithira</td>
											    <td>107.7 km SW of Kithira</td>
											    <td>2023-03-14 16:36:01.000</td>
											    <td>5.2</td>
											</tr>
											<tr>
											    <td>Poliyiros</td>
											    <td>31.1 km SSW of Poliyiros</td>
											    <td>2024-11-03 17:03:51.000</td>
											    <td>5.2</td>
											</tr>
											<tr>
											    <td>Karpathos</td>
											    <td>108.8 km SW of Karpathos</td>
											    <td>2022-09-03 04:13:09.000</td>
											    <td>5.2</td>
											</tr>
											</table>
											</div>	

											<button class="toggle-query-button" onclick="toggleQuery('query4')"><li><p> Listed the top 3 strongest earthquakes in each region.</p></li></button>
												
												<div id="query4" class="query-container">
<pre>
<code>
WITH MaxMagnitudePerRegion AS (
SELECT region_name, 
       MAX([Magnitude (ML)]) AS max_magnitude
FROM Earthquakes_Data
WHERE YEAR([Origin Time (GMT)]) = 2025
GROUP BY region_name
),

RankedQuakes AS (
SELECT r.region_name,
       e.[Origin Time (GMT)], 
	   e.[Magnitude (ML)], 
	   e.[Location],
       mmr.max_magnitude,
       ROW_NUMBER() OVER (PARTITION BY r.region_name 
			ORDER BY e.[Magnitude (ML)] DESC) AS row_num
FROM Earthquakes_Data e
JOIN Region_Dim r ON e.region_name = r.region_name
JOIN MaxMagnitudePerRegion mmr ON r.region_name = mmr.region_name
WHERE YEAR(e.[Origin Time (GMT)]) = 2025
)
SELECT region_name,
	   [Origin Time (GMT)], 
	   [Magnitude (ML)], 
	   [Location]
FROM RankedQuakes
WHERE row_num <= 3
ORDER BY max_magnitude DESC, 
		 region_name ASC, 
		 [Magnitude (ML)] DESC;
</code>
</pre>


													
<button class="toggle-explanation" onclick="toggleExplanation('explanation4')">Show Explanation</button>
<div id="explanation4" class="explanation" style="display: none;">
        <p>
	<ul>
        <li>Regions are first sorted based on their strongest earthquake (max_magnitude DESC).</li>
        <li>If they have the same maximum earthquake, they appear in alphabetical order (region_name ASC).</li>
        <li>Within each region, earthquakes are sorted from largest to smallest ([Magnitude (ML)] DESC).</li>
        <li>The max_magnitude is not returned in the final result because it is only used for sorting.</li>
        
	This approach ensures that:
        <ul>
            <p>✅ Exactly 3 earthquakes are displayed for each region.</p>
            <p>✅ Regions are correctly sorted based on their strongest earthquake.</p>
            <p>✅ Earthquakes within each region are in descending order of magnitude.</p>
        </ul>
        </ul>	
        </p>
    </div>
<div style="height: 20px;"></div> 
													

													
											<h3>Sample Results</h3>
											<table border="1">
											<tr>
											<th>Region_Name</th>
											<th>Location</th>
											<th>Origin Time (GMT)</th>
											<th>Magnitude (ML)</th>
											</tr>
												
											<tr>
											<td>Thira</td>
											<td>39.5 km NE of Thira</td>
											<td>2025-02-05 19:09:38.000</td>
											<td>5.2</td>
											</tr>
												
											<tr>
											<td>Thira</td>
											<td>33.4 km NE of Thira</td>
											<td>2025-02-17 07:49:50.000</td>
											<td>5.1</td>
											</tr>

											<tr>
											<td>Thira</td>
											<td>32.6 km NE of Thira</td>
											<td>2025-02-04 13:04:14.000</td>
											<td>5</td>
											</tr>

											<tr>
											<td>Mitilini</td>
											<td>27.0 km N of Mitilini</td>
											<td>2025-01-21 20:38:43.000</td>
											<td>5.1</td>
											</tr>

											<tr>
											<td>Mitilini</td>
											<td>26.6 km N of Mitilini</td>
											<td>2025-01-21 20:53:01.000</td>
											<td>2.7</td>
											</tr>

											<tr>
											<td>Mitilini</td>
											<td>28.1 km N of Mitilini</td>
											<td>2025-01-27 05:20:35.000</td>
											<td>2.6</td>
											</tr>

											<tr>
											<td>Kariai</td>
											<td>12.8 km WNW of Kariai</td>
											<td>2025-02-15 16:11:48.000</td>
											<td>4.7</td>
											</tr>
												
											<tr>
											<td>Kariai</td>
											<td>11.8 km WNW of Kariai</td>
											<td>2025-02-15 15:21:05.000</td>
											<td>3.5</td>
											</tr>
												
   											<tr>
											<td>Kariai</td>
											<td>9.1 km WNW of Kariai</td>
											<td>2025-02-16 00:33:18.000</td>
											<td>3.4</td>
											</tr>
												
											
											<tr>
    											<td>Pyrgos</td>
  											<td>37.9 km SSE of Pyrgos</td>
    											<td>2025-01-06 09:47:56.000</td>
    											<td>4.6</td>
											</tr>
											<tr>
											    <td>Pyrgos</td>
											    <td>40.6 km SSE of Pyrgos</td>
											    <td>2025-01-06 18:23:26.000</td>
											    <td>3.6</td>
											</tr>
											<tr>
											    <td>Pyrgos</td>
											    <td>38.5 km SSE of Pyrgos</td>
											    <td>2025-01-25 11:49:01.000</td>
											    <td>3.6</td>
											</tr>
											<tr>
											    <td>Skyros</td>
											    <td>31.0 km W of Skyros</td>
											    <td>2025-02-03 08:01:02.000</td>
											    <td>4.5</td>
											</tr>
											<tr>
											    <td>Skyros</td>
											    <td>70.9 km ESE of Skyros</td>
											    <td>2025-01-23 02:59:10.000</td>
											    <td>3.6</td>
											</tr>
											<tr>
											    <td>Skyros</td>
											    <td>69.7 km ESE of Skyros</td>
											    <td>2025-01-27 15:06:39.000</td>
											    <td>3.4</td>
											</tr>
											<tr>
											    <td>Chalkida</td>
											    <td>37.4 km E of Chalkida</td>
											    <td>2025-01-30 15:55:28.000</td>
											    <td>4.4</td>
											</tr>
											<tr>
											    <td>Chalkida</td>
											    <td>36.9 km E of Chalkida</td>
											    <td>2025-01-24 20:03:04.000</td>
											    <td>2.7</td>
											</tr>
											<tr>
											    <td>Chalkida</td>
											    <td>35.6 km ESE of Chalkida</td>
											    <td>2025-01-25 14:31:40.000</td>
											    <td>2.6</td>
											</tr>
											<tr>
											    <td>Zakynthos</td>
											    <td>49.4 km SW of Zakynthos</td>
											    <td>2025-01-31 07:36:03.000</td>
											    <td>4.1</td>
											</tr>
											<tr>
											    <td>Zakynthos</td>
											    <td>51.1 km SW of Zakynthos</td>
											    <td>2025-01-31 07:45:16.000</td>
											    <td>3.6</td>
											</tr>
											<tr>
											    <td>Zakynthos</td>
											    <td>63.0 km S of Zakynthos</td>
											    <td>2025-01-20 14:21:55.000</td>
											    <td>3.6</td>
											</tr>
											<tr>
											    <td>Chania</td>
											    <td>96.8 km SW of Chania</td>
											    <td>2025-01-03 11:58:10.000</td>
											    <td>4.0</td>
											</tr>
											<tr>
											    <td>Chania</td>
											    <td>138.5 km SSW of Chania</td>
											    <td>2025-01-12 05:26:38.000</td>
											    <td>3.3</td>
											</tr>
											<tr>
											    <td>Chania</td>
											    <td>62.9 km WSW of Chania</td>
											    <td>2025-01-11 02:42:24.000</td>
											    <td>3.2</td>
											</tr>
											<tr>
											    <td>Patras</td>
											    <td>8.5 km W of Patras</td>
											    <td>2025-02-07 04:24:25.000</td>
											    <td>4.0</td>
											</tr>
											<tr>
											    <td>Patras</td>
											    <td>10.6 km W of Patras</td>
											    <td>2025-02-07 06:03:40.000</td>
											    <td>3.4</td>
											</tr>
											<tr>
											    <td>Patras</td>
											    <td>8.2 km N of Patras</td>
											    <td>2025-02-06 12:33:00.000</td>
											    <td>3.0</td>
											</tr>
											</table>
											</div>

												
									<h4>3. Monthly Earthquake Trends</h4>
											<button class="toggle-query-button" onclick="toggleQuery('query5')"><li><p> Monthly Average Earthquake Counts</p></li></button>
												
												<div id="query5" class="query-container">
<pre>
<code>
SELECT r.region_name, 
       AVG(Monthly_Count) AS avg_per_month
FROM (
SELECT e.region_name, 
       YEAR(e.[Origin Time (GMT)]) * 12 + MONTH(e.[Origin Time (GMT)]) AS year_month,
       COUNT(e.[Magnitude (ML)]) AS Monthly_Count
  FROM Earthquakes_Data e
  WHERE YEAR(e.[Origin Time (GMT)]) = YEAR(GETDATE())
  GROUP BY e.region_name, YEAR(e.[Origin Time (GMT)]) * 12 + MONTH(e.[Origin Time (GMT)])
) AS Monthly_Summary
JOIN Region_Dim r ON Monthly_Summary.region_name = r.region_name
GROUP BY r.region_name
ORDER BY avg_per_month DESC;
</code>
</pre>

<button class="toggle-explanation" onclick="toggleExplanation('explanation5')">Show Explanation</button>
<div id="explanation5" class="explanation" style="display: none;">
        <p>
	<ul>
        <li>Monthly earthquake count calculation: In the inner subquery, we calculate the number of earthquakes per month (separating the year and month using the expression YEAR(e.[Origin Time (GMT)]) * 12 + MONTH(e.[Origin Time (GMT)])).</li>
        <li>Average earthquakes per month: In the outer query, we use the AVG() function to compute the average number of earthquakes per month.</li>
        <li>Grouping by region: We group the result by region and sort it in descending order based on avg_per_month.</li>

	✅ This approach accurately calculates the average number of earthquakes per month for each region.
        </ul>	
        </p>
    </div>
<div style="height: 20px;"></div> 													

													
											<h3>Sample Results</h3>
											<table border="1" >
											<tr>
											<th>Region_Name</th>
											<th>Average Earthquake per month</th>
											</tr>
												
											    <td>Thira</td>
											    <td>844</td>
											</tr>
											<tr>
											    <td>Pyrgos</td>
											    <td>289</td>
											</tr>
											<tr>
											    <td>Aegion</td>
											    <td>111</td>
											</tr>
											<tr>
											    <td>Kariai</td>
											    <td>82</td>
											</tr>
											<tr>
											    <td>Zakynthos</td>
											    <td>74</td>
											</tr>
											<tr>
											    <td>Drama</td>
											    <td>57</td>
											</tr>
											<tr>
											    <td>Patras</td>
											    <td>49</td>
											</tr>
											<tr>
											    <td>Methoni</td>
											    <td>46</td>
											</tr>
											<tr>
											    <td>Chalkida</td>
											    <td>45</td>
											</tr>
											<tr>
											    <td>Karpenision</td>
											    <td>42</td>
											</tr>
											<tr>
											    <td>Poliyiros</td>
											    <td>42</td>
											</tr>
											<tr>
											    <td>Argostoli</td>
											    <td>39</td>
											</tr>
											<tr>
											    <td>Athens</td>
											    <td>38</td>
											</tr>
											<tr>
											    <td>Mesolonghi</td>
											    <td>35</td>
											</tr>
											<tr>
											    <td>Skiathos</td>
											    <td>32</td>
											</tr>
											<tr>
											    <td>Andravida</td>
											    <td>30</td>
											</tr>
											<tr>
											    <td>Chania</td>
											    <td>29</td>
											</tr>
											</table>
											</div>		

											<button class="toggle-query-button" onclick="toggleQuery('query6')"><li><p> Earthquake Frequency by Day of the Week.</p></li></button>
												
												<div id="query6" class="query-container">
<pre>
<code>
SELECT DATENAME(WEEKDAY, [Origin Time (GMT)]) AS day_of_week, 
       COUNT(*) AS earthquake_count
FROM Earthquakes_Data
WHERE YEAR([Origin Time (GMT)]) = 2024 
GROUP BY DATENAME(WEEKDAY, 
	[Origin Time (GMT)])
ORDER BY earthquake_count DESC;
</code>
</pre>

<button class="toggle-explanation" onclick="toggleExplanation('explanation6')">Show Explanation</button>
<div id="explanation6" class="explanation" style="display: none;">
        <p>
	<ul>
        <p>✅ Use of DATENAME(WEEKDAY, ...), which returns the name of the day (e.g., "Monday", "Tuesday").</p>  
        <p>✅ Grouping based on the day name, which works correctly if the SQL Server language setting is in English. </p> 
        <p>✅ Sorting based on the number of earthquakes (COUNT(*)), so days with the most earthquakes appear first. </p> 
	</ul>
	<div style="height: 20px;"></div>
        </p>
    </div>
<div style="height: 20px;"></div>  
													
													
<h3>Sample Results</h3>
											<table border="1" >
											<tr>
											<th>Day of week</th>
											<th>Earthquake count</th>
											</tr>
												
											   <tr>
											    <td>Tuesday</td>
											    <td>3524</td>
											</tr>
											<tr>
											    <td>Saturday</td>
											    <td>3430</td>
											</tr>
											<tr>
											    <td>Sunday</td>
											    <td>3424</td>
											</tr>
											<tr>
											    <td>Wednesday</td>
											    <td>3328</td>
											</tr>
											<tr>
											    <td>Monday</td>
											    <td>3300</td>
											</tr>
											<tr>
											    <td>Friday</td>
											    <td>3143</td>
											</tr>
											<tr>
											    <td>Thursday</td>
											    <td>3092</td>
											</tr>

											</table>
											</div>		

									<h4>4. Depth vs. Magnitude Correlation</h4>		

												
											<button class="toggle-query-button" onclick="toggleQuery('query7')"><li><p>Examined if earthquakes are occurring at greater depths over time.</p></li></button>
												
												<div id="query7" class="query-container">
<pre>
<code>
WITH DepthTrends AS (
    SELECT [Region_name], YEAR([Origin Time (GMT)]) AS Year, AVG([Depth (km)]) AS Avg_Depth
    FROM Earthquakes_Data
    GROUP BY [region_name], YEAR([Origin Time (GMT)])
)
, DepthChange AS (
    SELECT d.region_name, d.quake_year, d.avg_depth,
           LAG(d.avg_depth) OVER (PARTITION BY d.region_name ORDER BY d.quake_year) AS Prev_year_Depth,
           d.avg_depth - LAG(d.avg_depth) OVER (PARTITION BY d.region_name ORDER BY d.quake_year) AS Depth_change
    FROM DepthTrends d
)
SELECT r.region_name, dc.quake_year, dc.avg_depth, dc.prev_year_depth, dc.depth_change
FROM DepthChange dc
JOIN Region_Dim r ON dc.region_name = r.region_name
WHERE dc.depth_change > 0 
ORDER BY dc.region_name, dc.quake_year DESC;
</code>
</pre>

<button class="toggle-explanation" onclick="toggleExplanation('explanation7')">Show Explanation</button>
<div id="explanation7" class="explanation" style="display: none;">
        <p>
	<ul>
        ✅ Useful for determining whether earthquakes in a region are occurring at increasing depths within the Earth.  
	<div style="height: 20px;"></div>
        <li>In the first WITH statement, we calculate the average depth (avg_depth) of earthquakes for each region and year.</li>
        <li>In the second WITH statement, we compute the depth difference between the current and previous year using the LAG() function.</li>
        <li>In the final SELECT, we filter using WHERE dc.depth_change > 0 to identify regions where earthquake depths are increasing over the years.</li>
	<li>Results are sorted by region and year, with the most recent results appearing first.</li>
        </ul>
        </p>
    </div>
<div style="height: 20px;"></div>  

													
<h3>Sample Results</h3>
													

													
											<table border="1">
											<tr>
											<th>Region name</th>
											<th>Year</th>
											<th>Avg_Depth</th>
											<th>Prev_year_Depth</th>
											<th>Depth_change</th>
											</tr>
												
											  <tr>
											    <td>Aegion</td>
											    <td>2025</td>
											    <td>13.981981981982</td>
											    <td>11.6583732057416</td>
											    <td>2.32360877624035</td>
											</tr>
											<tr>
											    <td>Aegion</td>
											    <td>2024</td>
											    <td>11.6583732057416</td>
											    <td>11.5705741626794</td>
											    <td>0.0877990430622013</td>
											</tr>
											<tr>
											    <td>Andros</td>
											    <td>2025</td>
											    <td>18</td>
											    <td>15.1176470588235</td>
											    <td>2.88235294117647</td>
											</tr>
											<tr>
											    <td>Andros</td>
											    <td>2024</td>
											    <td>15.1176470588235</td>
											    <td>14.4117647058824</td>
											    <td>0.705882352941176</td>
											</tr>
											<tr>
											    <td>Andros</td>
											    <td>2023</td>
											    <td>14.4117647058824</td>
											    <td>12.9636363636364</td>
											    <td>1.44812834224599</td>
											</tr>
											<tr>
											    <td>Arta</td>
											    <td>2024</td>
											    <td>18.3653846153846</td>
											    <td>18.3305084745763</td>
											    <td>0.0348761408083469</td>
											</tr>
											<tr>
											    <td>Arta</td>
											    <td>2023</td>
											    <td>18.3305084745763</td>
											    <td>18.0028818443804</td>
											    <td>0.327626630195866</td>
											</tr>
											<tr>
											    <td>Athens</td>
											    <td>2025</td>
											    <td>14.3246753246753</td>
											    <td>13.2027777777778</td>
											    <td>1.12189754689755</td>
											</tr>
											<tr>
											    <td>Athens</td>
											    <td>2024</td>
											    <td>13.2027777777778</td>
											    <td>11.7930434782609</td>
											    <td>1.40973429951691</td>
											</tr>
											<tr>
											    <td>Chalkida</td>
											    <td>2024</td>
											    <td>12.7262569832402</td>
											    <td>11.8602150537634</td>
											    <td>0.866041929476783</td>
											</tr>
											<tr>
											    <td>Chalkida</td>
											    <td>2023</td>
											    <td>11.8602150537634</td>
											    <td>10.2711759230531</td>
											    <td>1.58903913071038</td>
											</tr>
											</table>
											</div>		

												
									<h4>5. Earthquake Clusters and Patterns</h4>
												
											<button class="toggle-query-button" onclick="toggleQuery('query8')"><li><p>Detected regions experiencing earthquake swarms within 48-hour periods.</p></li></button>
												
												<div id="query8" class="query-container">
<pre>
<code>
WITH QuakeClusters AS (
    SELECT e1.[region_name], e1.[Origin Time (GMT)], COUNT(*) AS cluster_size
    FROM Earthquakes_Data e1
    JOIN Earthquakes_Data e2
        ON e1.[region_name] = e2.[region_name]
        AND e2.[Origin Time (GMT)] BETWEEN e1.[Origin Time (GMT)] AND DATEADD(HOUR, 48, e1.[Origin Time (GMT)])
    GROUP BY e1.[region_name], e1.[Origin Time (GMT)]
    HAVING COUNT(*) > 5
)
SELECT r.region_name, q.[Origin Time (GMT)], q.cluster_size
FROM QuakeClusters q
JOIN Region_Dim r ON q.[region_name] = r.[region_name]
ORDER BY q.[Origin Time (GMT)] DESC,q.cluster_size DESC ;
</code>
</pre>

<button class="toggle-explanation" onclick="toggleExplanation('explanation8')">Show Explanation</button>
<div id="explanation8" class="explanation" style="display: none;">
        <p>
	<ul>
        ✅ Useful for detecting whether there is an "outbreak" of earthquakes in a short period.  
	The query identifies regions where more than 5 earthquakes occurred within a 48-hour period.  
	In the given example, we observe multiple seismic events occurring at close time intervals and locations.  
	<p>Solution steps:</p>
        <li>Time restriction: We need a proper comparison for timestamps (within 48 hours) and data belonging to the same region.</li>
        <li>Earthquake aggregation: We must count the earthquakes in each region within the 48-hour period.</li>
        <li>Filtering: The filter for "more than 5 earthquakes" must be applied correctly for the calculated time window.</li>
	<li>Results are sorted by region and year, with the most recent results appearing first.</li>
	Analysis:
	<li>JOIN Earthquakes_Data e1 with e2: We compare each earthquake with all other earthquakes in the same region within a 48-hour difference.</li>
	<li>HAVING COUNT(*) > 5: We filter for regions with more than 5 earthquakes within the 48-hour window.</li>
	<li>DATEADD(HOUR, 48, e1.[Origin Time (GMT)]): The DATEADD function is used to add 48 hours to an earthquake’s timestamp to create the 48-hour range.</li>
	<li>COUNT(*) AS cluster_size: This counts the number of earthquakes occurring within 48 hours of an initial earthquake in the same region (e1.[region_name] = e2.[region_name]).</li>
	
	If the cluster_size is greater than 5, then we consider that more than 5 earthquakes occurred in that region within that period, which may indicate a "seismic swarm" or an earthquake cluster.  
	For example, if 10 earthquakes occurred within 48 hours in the Thira region, the cluster size for this group of earthquakes would be 10.
        </p>
    </div>
<div style="height: 20px;"></div> 	  												
													
											</div>														
											<button class="toggle-query-button" onclick="toggleQuery('query9')"><li><p> Identified locations with recurring earthquake activity.</p></li></button>
												
												<div id="query9" class="query-container">
													<pre>
<code>
WITH QuakeIntervals AS (
    SELECT region_name, [Origin Time (GMT)], [Magnitude (ML)],
           LAG([Origin Time (GMT)]) OVER (PARTITION BY region_name ORDER BY [Origin Time (GMT)]) AS prev_quake_time
    FROM Earthquakes_Data
    WHERE [Magnitude (ML)] > 4.7
)
SELECT r.region_name, q.[Origin Time (GMT)], q.[Magnitude (ML)],
       DATEDIFF(DAY, q.prev_quake_time, q.[Origin Time (GMT)]) AS days_since_last_big_quake
FROM QuakeIntervals q
JOIN Region_Dim r ON q.region_name = r.region_name
ORDER BY r.region_name, q.[Origin Time (GMT)];

</code>
</pre>

<button class="toggle-explanation" onclick="toggleExplanation('explanation9')">Show Explanation</button>
<div id="explanation9" class="explanation" style="display: none;">
        <p>
	<ul>
        ✅ Useful for understanding whether strong earthquakes occur at a certain frequency.
	<div style="height: 20px;"></div>
        </p>
    </div>
<div style="height: 20px;"></div>  														
													
<h3>Sample Results</h3>
											<table border="1" >
											<tr>
											<th>Region name</th>
											<th>Origin Time (GMT)</th>
											<th>Mgnitude (ML)</th>
											<th>days_since_last_big_equake</th>
											</tr>
												    <tr><td>Amfissa</td><td>2022-10-08 22:02:28.000</td><td>5</td><td>NULL</td></tr>
												    <tr><td>Andravida</td><td>2024-07-06 17:34:29.000</td><td>4.9</td><td>NULL</td></tr>
												    <tr><td>Argostoli</td><td>2022-09-08 07:36:20.000</td><td>5.4</td><td>NULL</td></tr>
												    <tr><td>Atalanti</td><td>2023-06-08 12:33:52.000</td><td>4.8</td><td>NULL</td></tr>
												    <tr><td>Athens</td><td>2022-11-29 20:06:39.000</td><td>5</td><td>NULL</td></tr>
												    <tr><td>Chalkida</td><td>2022-12-28 12:24:20.000</td><td>4.9</td><td>NULL</td></tr>
												    <tr><td>Chalkida</td><td>2023-11-03 06:26:37.000</td><td>5.1</td><td>310</td></tr>
												    <tr><td>Chania</td><td>2023-08-13 07:49:31.000</td><td>4.9</td><td>NULL</td></tr>
												    <tr><td>Chania</td><td>2024-07-21 04:01:29.000</td><td>5.3</td><td>343</td></tr>
												    <tr><td>Florina</td><td>2022-01-09 21:43:47.000</td><td>5.3</td><td>NULL</td></tr>
												    <tr><td>Iraklion</td><td>2022-10-02 04:04:00.000</td><td>5</td><td>NULL</td></tr>
												    <tr><td>Iraklion</td><td>2023-05-18 18:58:52.000</td><td>5.1</td><td>228</td></tr>
												    <tr><td>Iraklion</td><td>2024-08-07 08:23:52.000</td><td>4.8</td><td>447</td></tr>
												    <tr><td>Iraklion</td><td>2024-12-22 19:09:56.000</td><td>4.8</td><td>137</td></tr>
												    <tr><td>Kariai</td><td>2022-01-16 11:48:05.000</td><td>5.4</td><td>NULL</td></tr>
												    <tr><td>Karpathos</td><td>2022-06-19 23:24:35.000</td><td>4.8</td><td>NULL</td></tr>
												    <tr><td>Karpathos</td><td>2022-09-03 04:13:09.000</td><td>5.2</td><td>76</td></tr>
												    <tr><td>Karpathos</td><td>2022-11-13 02:08:08.000</td><td>4.8</td><td>71</td></tr>
												    <tr><td>Karpathos</td><td>2022-11-20 23:25:01.000</td><td>5.5</td><td>7</td></tr>
												    <tr><td>Karpathos</td><td>2024-10-19 07:08:30.000</td><td>4.8</td><td>699</td></tr>
												    <tr><td>Kithira</td><td>2022-04-16 17:00:39.000</td><td>4.9</td><td>NULL</td></tr>
												    <tr><td>Kithira</td><td>2022-04-27 01:51:53.000</td><td>5.2</td><td>11</td></tr>
												    <tr><td>Kithira</td><td>2023-03-14 16:36:01.000</td><td>5.2</td><td>321</td></tr>
												    <tr><td>Leonidhion</td><td>2024-01-16 05:20:51.000</td><td>4.8</td><td>NULL</td></tr>
												    <tr><td>Mitilini</td><td>2023-01-07 01:52:58.000</td><td>4.9</td><td>NULL</td></tr>
												    <tr><td>Mitilini</td><td>2023-01-10 07:38:30.000</td><td>4.8</td><td>3</td></tr>
												    <tr><td>Mitilini</td><td>2025-01-21 20:38:43.000</td><td>5.1</td><td>742</td></tr>
												    <tr><td>Poliyiros</td><td>2024-11-03 17:03:51.000</td><td>5.2</td><td>NULL</td></tr>
												    <tr><td>Pyrgos</td><td>2024-03-29 07:12:48.000</td><td>5.8</td><td>NULL</td></tr>
												    <tr><td>Rethimnon</td><td>2024-08-28 16:29:55.000</td><td>5.2</td><td>NULL</td></tr>
												    <tr><td>Rodhos</td><td>2023-01-25 12:37:06.000</td><td>5.9</td><td>NULL</td></tr>
												    <tr><td>Rodhos</td><td>2024-06-12 19:19:11.000</td><td>4.8</td><td>504</td></tr>
												    <tr><td>Rodhos</td><td>2024-10-15 16:54:22.000</td><td>4.8</td><td>125</td></tr>
												    <tr><td>Samos</td><td>2022-08-14 03:24:22.000</td><td>4.8</td><td>NULL</td></tr>
												</table>
											</div>		

									
									<h4>6. Spatial Analysis of Earthquakes</h4>
										
											<button class="toggle-query-button" onclick="toggleQuery('query10')"><li><p>Found earthquakes occurring within a 60 to 100 km radius of major cities (e.g. Santorini).</p></li></button>
												
												<div id="query10" class="query-container">
<pre>
<code>
DECLARE @latitude FLOAT = 36.3932;  -- Thira (Santorini)
DECLARE @longitude FLOAT = 25.4615;
DECLARE @radius1 FLOAT = 60.0;  -- in kilometers
DECLARE @radius2 FLOAT = 100.0;


WITH EarthquakeDistances AS (
    SELECT e.*, 
           round((6371 * ACOS(COS(RADIANS(@latitude)) * COS(RADIANS(e.latitude)) * 
                COS(RADIANS(e.longitude) - RADIANS(@longitude)) + 
                SIN(RADIANS(@latitude)) * SIN(RADIANS(e.latitude)))),2) AS distance_km
    FROM Earthquakes_Data e
    WHERE YEAR(e.[Origin Time (GMT)]) = YEAR(GETDATE())  -- Only for the last year
)
SELECT *
FROM EarthquakeDistances
WHERE distance_km between @radius1 and @radius2
ORDER BY distance_km;
</code>
</pre>


													
<h3> Results</h3>
											<table border="1" >
											    <tr>
											        <th>Origin Time (GMT)</th>
											        <th>Latitude</th>
											        <th>Longitude</th>
											        <th>Depth (km)</th>
											        <th>Magnitude (ML)</th>
											        <th>Location</th>
											        <th>Region Name</th>
											        <th>Distance (km)</th>
											    </tr>
											                <tr><td>2025-01-26 19:51:59.000</td><td>36,8042</td><td>25,9937</td><td>13</td><td>2,1</td><td>64.3 km ESE of Naxos</td><td>Naxos</td><td>65,92</td></tr>
												        <tr><td>2025-01-27 18:32:35.000</td><td>35,7944</td><td>25,5569</td><td>8</td><td>2,7</td><td>64.9 km NE of Iraklion</td><td>Iraklion</td><td>67,13</td></tr>
												        <tr><td>2025-01-27 19:49:18.000</td><td>35,7889</td><td>25,5551</td><td>10</td><td>2,5</td><td>64.3 km NE of Iraklion</td><td>Iraklion</td><td>67,72</td></tr>
												        <tr><td>2025-01-13 13:07:50.000</td><td>35,7852</td><td>25,5185</td><td>12</td><td>2,6</td><td>62.0 km NE of Iraklion</td><td>Iraklion</td><td>67,8</td></tr>
												        <tr><td>2025-01-10 22:13:12.000</td><td>35,7724</td><td>25,4855</td><td>13</td><td>2,5</td><td>59.2 km NNE of Iraklion</td><td>Iraklion</td><td>69,06</td></tr>
												        <tr><td>2025-01-04 14:42:54.000</td><td>35,7678</td><td>25,448</td><td>13</td><td>2,2</td><td>57.0 km NNE of Iraklion</td><td>Iraklion</td><td>69,55</td></tr>
												        <tr><td>2025-01-12 18:10:06.000</td><td>35,7651</td><td>25,48</td><td>13</td><td>2,4</td><td>58.3 km NNE of Iraklion</td><td>Iraklion</td><td>69,86</td></tr>
												        <tr><td>2025-01-15 02:02:33.000</td><td>37,0203</td><td>25,3821</td><td>192</td><td>3</td><td>9.5 km S of Naxos</td><td>Naxos</td><td>70,09</td></tr>
												        <tr><td>2025-01-06 07:29:46.000</td><td>35,7632</td><td>25,4361</td><td>12</td><td>2</td><td>56.0 km NNE of Iraklion</td><td>Iraklion</td><td>70,09</td></tr>
												        <tr><td>2025-01-12 01:10:21.000</td><td>35,7578</td><td>25,4819</td><td>18</td><td>2</td><td>57.7 km NNE of Iraklion</td><td>Iraklion</td><td>70,68</td></tr>
												        <tr><td>2025-01-20 21:11:35.000</td><td>35,7578</td><td>25,491</td><td>18</td><td>2,7</td><td>58.1 km NE of Iraklion</td><td>Iraklion</td><td>70,7</td></tr>
												        <tr><td>2025-01-03 12:23:53.000</td><td>35,7559</td><td>25,4288</td><td>45</td><td>2,4</td><td>55.0 km NNE of Iraklion</td><td>Iraklion</td><td>70,93</td></tr>
												        <tr><td>2025-01-07 02:15:06.000</td><td>35,7541</td><td>25,4361</td><td>30</td><td>1,7</td><td>55.1 km NNE of Iraklion</td><td>Iraklion</td><td>71,1</td></tr>
												        <tr><td>2025-01-04 02:44:30.000</td><td>35,7468</td><td>25,4727</td><td>11</td><td>1,9</td><td>56.2 km NNE of Iraklion</td><td>Iraklion</td><td>71,88</td></tr>
												        <tr><td>2025-01-15 00:33:36.000</td><td>35,7468</td><td>25,4855</td><td>14</td><td>2,8</td><td>56.8 km NE of Iraklion</td><td>Iraklion</td><td>71,91</td></tr>
												        <tr><td>2025-01-04 02:39:07.000</td><td>35,744</td><td>25,4681</td><td>13</td><td>1,8</td><td>55.7 km NNE of Iraklion</td><td>Iraklion</td><td>72,19</td></tr>
												        <tr><td>2025-01-08 05:25:45.000</td><td>35,7431</td><td>25,4727</td><td>20</td><td>2,1</td><td>55.9 km NNE of Iraklion</td><td>Iraklion</td><td>72,29</td></tr>
												        <tr><td>2025-01-03 18:51:16.000</td><td>35,7426</td><td>25,4512</td><td>16</td><td>2,9</td><td>54.8 km NNE of Iraklion</td><td>Iraklion</td><td>72,35</td></tr>
												        <tr><td>2025-01-22 04:58:18.000</td><td>35,7408</td><td>25,4576</td><td>12</td><td>3,4</td><td>54.9 km NNE of Iraklion</td><td>Iraklion</td><td>72,54</td></tr>
												        <tr><td>2025-01-23 01:46:37.000</td><td>35,7339</td><td>25,4709</td><td>16</td><td>1,8</td><td>54.9 km NE of Iraklion</td><td>Iraklion</td><td>73,32</td></tr>
												        <tr><td>2025-01-03 13:50:19.000</td><td>35,7339</td><td>25,4929</td><td>17</td><td>1,7</td><td>56.1 km NE of Iraklion</td><td>Iraklion</td><td>73,37</td></tr>
												        <tr><td>2025-01-22 08:14:21.000</td><td>35,7321</td><td>25,3848</td><td>32</td><td>2,1</td><td>50.8 km NNE of Iraklion</td><td>Iraklion</td><td>73,83</td></tr>
												        <tr><td>2025-01-08 14:05:25.000</td><td>35,7477</td><td>25,6696</td><td>32</td><td>1,7</td><td>67.7 km NE of Iraklion</td><td>Iraklion</td><td>74,17</td></tr>
												        <tr><td>2025-01-30 04:24:03.000</td><td>36,3712</td><td>26,3846</td><td>114</td><td>3,5</td><td>85.3 km E of Thira</td><td>Thira</td><td>82,67</td></tr>
												        <tr><td>2025-01-11 19:56:26.000</td><td>35,6754</td><td>25,8353</td><td>33</td><td>1,9</td><td>74.8 km ENE of Iraklion</td><td>Iraklion</td><td>86,6</td></tr>
												        <tr><td>2025-01-26 23:31:55.000</td><td>36,5643</td><td>26,4459</td><td>138</td><td>3,1</td><td>83.6 km WSW of Kos</td><td>Kos</td><td>90,05</td></tr>
											</table>
											</div>

									<button class="toggle-query-button" onclick="toggleQuery('query11')"><li><p>Found earthquakes occurring within a 90 to 100 km radius of major cities (e.g. Athens)</p></li></button>
												
												<div id="query11" class="query-container">
<pre>
<code>
DECLARE @latitude FLOAT = 37.9838;  -- Athens
DECLARE @longitude FLOAT = 23.7275;
DECLARE @radius1 FLOAT = 90.0;  -- in kilometers
DECLARE @radius2 FLOAT = 100.0;


WITH EarthquakeDistances AS (
    SELECT e.*, 
           round((6371 * ACOS(COS(RADIANS(@latitude)) * COS(RADIANS(e.latitude)) * 
                COS(RADIANS(e.longitude) - RADIANS(@longitude)) + 
                SIN(RADIANS(@latitude)) * SIN(RADIANS(e.latitude)))),2) AS distance_km
    FROM Earthquakes_Data e
    WHERE YEAR(e.[Origin Time (GMT)]) = YEAR(GETDATE())  -- Only for the last year
)
SELECT *
FROM EarthquakeDistances
WHERE distance_km between @radius1 and @radius2
ORDER BY distance_km;
</code>
</pre>

<button class="toggle-explanation" onclick="toggleExplanation('explanation10')">Show Explanation</button>
<div id="explanation10" class="explanation" style="display: none;">
        <p>
	<ul>
        ✅ Finding earthquakes within a 100 km radius from Athens (coordinates: latitude=37.9838, longitude=23.7275).
        <li>The formula calculates the distance between two points on Earth using the Haversine Formula.</li>
        <li>We filter only earthquakes between 90 km and 100 km and sort them by distance.</li>
	Explanation of coordinates:
	<li>@latitude and @longitude: Define the center of the search area (Athens in this case).</li>
	<li>@radius: The maximum distance in kilometers to search for earthquakes.</li>
	<li>The ACOS formula calculates the great-circle distance between two points on the Earth's surface, using the Haversine formula approximation.</li>
        </p>
    </div>
<div style="height: 20px;"></div>
													
<h3>Results</h3>
											<table border="2" >
											    <tr>
											        <th>Origin Time (GMT)</th>
											        <th>Latitude</th>
											        <th>Longitude</th>
											        <th>Depth (km)</th>
											        <th>Magnitude (ML)</th>
											        <th>Location</th>
											        <th>Region Name</th>
											        <th>Distance (km)</th>
											    </tr>
											   	<tr><td>2025-01-01 14:15:09.000</td><td>38,091</td><td>22,6964</td><td>13</td><td>0,9</td><td>26.8 km NW of Korinthos</td><td>Korinthos</td><td>91,08</td></tr>
											        <tr><td>2025-01-08 01:22:44.000</td><td>38,2018</td><td>22,7184</td><td>16</td><td>1</td><td>29.3 km SSW of Levadhia</td><td>Levadhia</td><td>91,57</td></tr>
											        <tr><td>2025-01-08 01:34:35.000</td><td>38,1912</td><td>22,7133</td><td>15</td><td>1,4</td><td>30.5 km SSW of Levadhia</td><td>Levadhia</td><td>91,71</td></tr>
											        <tr><td>2025-01-01 13:34:59.000</td><td>38,8023</td><td>23,5524</td><td>15</td><td>1</td><td>37.9 km N of Chalkida</td><td>Chalkida</td><td>92,28</td></tr>
											        <tr><td>2025-01-02 16:33:20.000</td><td>37,8868</td><td>22,6772</td><td>6</td><td>0,7</td><td>23.1 km WSW of Korinthos</td><td>Korinthos</td><td>92,74</td></tr>
											        <tr><td>2025-02-07 16:53:35.000</td><td>37,1686</td><td>23,5016</td><td>86</td><td>2,4</td><td>57.3 km E of Leonidhion</td><td>Leonidhion</td><td>92,81</td></tr>
											        <tr><td>2025-02-03 16:39:28.000</td><td>38,1473</td><td>22,6859</td><td>15</td><td>0,8</td><td>31.8 km NW of Korinthos</td><td>Korinthos</td><td>92,98</td></tr>
											        <tr><td>2025-01-04 18:24:45.000</td><td>38,5918</td><td>22,9848</td><td>10</td><td>1,3</td><td>6.7 km S of Atalanti</td><td>Atalanti</td><td>93,66</td></tr>
											        <tr><td>2025-01-26 05:05:31.000</td><td>38,1523</td><td>22,6762</td><td>17</td><td>1,5</td><td>32.7 km NW of Korinthos</td><td>Korinthos</td><td>93,92</td></tr>
											        <tr><td>2025-01-27 22:45:45.000</td><td>38,2022</td><td>22,6657</td><td>16</td><td>0,7</td><td>31.6 km SW of Levadhia</td><td>Levadhia</td><td>96,04</td></tr>
											        <tr><td>2025-01-01 18:18:59.000</td><td>38,0443</td><td>22,6286</td><td>11</td><td>1,2</td><td>29.1 km WNW of Korinthos</td><td>Korinthos</td><td>96,5</td></tr>
											        <tr><td>2025-01-04 12:51:33.000</td><td>38,578</td><td>22,9079</td><td>15</td><td>1,3</td><td>11.4 km SW of Atalanti</td><td>Atalanti</td><td>97,38</td></tr>
											        <tr><td>2025-01-15 14:12:55.000</td><td>38,0617</td><td>22,6186</td><td>9</td><td>1,5</td><td>30.7 km WNW of Korinthos</td><td>Korinthos</td><td>97,52</td></tr>
											        <tr><td>2025-01-04 21:35:05.000</td><td>38,167</td><td>22,6305</td><td>12</td><td>1,5</td><td>36.6 km SW of Levadhia</td><td>Levadhia</td><td>98,16</td></tr>
											        <tr><td>2025-01-12 09:18:20.000</td><td>37,1008</td><td>23,822</td><td>97</td><td>2,1</td><td>58.3 km W of Seriphos</td><td>Seriphos</td><td>98,54</td></tr>
											        <tr><td>2025-01-03 15:05:39.000</td><td>37,2263</td><td>23,1345</td><td>13</td><td>1,4</td><td>25.5 km ENE of Leonidhion</td><td>Leonidhion</td><td>99,11</td></tr>
											        <tr><td>2025-01-03 09:42:39.000</td><td>38,8783</td><td>23,654</td><td>17</td><td>1,3</td><td>35.3 km SSE of Skiathos</td><td>Skiathos</td><td>99,67</td></tr>
											        <tr><td>2025-01-01 01:14:16.000</td><td>38,2082</td><td>22,6213</td><td>12</td><td>1,6</td><td>33.5 km SW of Levadhia</td><td>Levadhia</td><td>99,96</td></tr>
											</table>
											</div>
												<!--<li><p> Assessed proximity-based earthquake risk for different locations.</p></li>	-->										
											
												
									<h4> 7. Risk Assessment for Future Earthquakes</h4>
	  
									<button class="toggle-query-button" onclick="toggleQuery('query12')"><li><p>Identified of Major Earthquake Events Exceeding Regional Averages</p></li></button>
												
												<div id="query12" class="query-container">
<pre>
<code>
WITH AvgMagnitude AS (
    SELECT [region_name], ROUND(AVG([Magnitude (ML)]), 2) AS avg_magnitude
    FROM Earthquakes_Data
    GROUP BY [region_name]
),
RankedEarthquakes AS (
    SELECT 
        r.region_name,
        e.[Origin Time (GMT)], 
        e.[Magnitude (ML)], 
        a.avg_magnitude,
        ROW_NUMBER() OVER (PARTITION BY r.region_name ORDER BY e.[Magnitude (ML)] DESC) AS rn
    FROM Earthquakes_Data e
    JOIN AvgMagnitude a ON e.[region_name] = a.[region_name]
    JOIN Region_Dim r ON e.[region_name] = r.[region_name]
    WHERE e.[Magnitude (ML)] > (a.avg_magnitude + 1.5)
    AND YEAR(e.[Origin Time (GMT)]) = YEAR(GETDATE())
)
SELECT region_name, [Origin Time (GMT)], [Magnitude (ML)], avg_magnitude
FROM RankedEarthquakes
WHERE rn = 1
ORDER BY region_name;
</code>
</pre>

<button class="toggle-explanation" onclick="toggleExplanation('explanation10')">Show Explanation</button>
<div id="explanation10" class="explanation" style="display: none;">
        <p>
	<ul>
        ✅ Detecting earthquakes that are significantly stronger than the average for a region.
	Explanation:
        <li>CTE AvgMagnitude: This Common Table Expression calculates the average earthquake magnitude for each region.</li>
        <li>CTE RankedEarthquakes:
	In this CTE, we use the ROW_NUMBER() function to rank earthquakes by region (PARTITION BY r.region_name) and assign them a descending order based on magnitude (ORDER BY e.[Magnitude (ML)] DESC).
	This ensures that the largest earthquake in each region gets the number rn = 1.</li>
	Final Selection:
	<li>In the final SELECT statement, we filter to keep only the records where rn = 1, meaning the largest earthquake for each region.</li>
	<li>Sorting: The final selection is sorted by region name.</li>
	Result:
	With this approach, we get exactly one result per region, which is the strongest earthquake that exceeds the average magnitude by 1.5 and has been recorded in the current year.
        </p>
    </div>
<div style="height: 20px;"></div>  
													
<h3>Results</h3>
											<table border="1" >
											    <tr>
											 <table>
											    <tr>
											        <th>Region Name</th>
											        <th>Origin Time (GMT)</th>
											        <th>Magnitude (ML)</th>
											        <th>Average Magnitude</th>
											    </tr>
											    <tr>
											        <td>Aegion</td>
											        <td>2025-01-09 05:54:14.000</td>
											        <td>3,8</td>
											        <td>1,18</td>
											    </tr>
											    <tr>
											        <td>Amfissa</td>
											        <td>2025-01-31 07:28:56.000</td>
											        <td>3,2</td>
											        <td>1,28</td>
											    </tr>
											    <tr>
											        <td>Andravida</td>
											        <td>2025-01-10 19:23:52.000</td>
											        <td>3,5</td>
											        <td>1,61</td>
											    </tr>
											    <tr>
											        <td>Argostoli</td>
											        <td>2025-01-27 15:42:55.000</td>
											        <td>3,3</td>
											        <td>1,78</td>
											    </tr>
											    <tr>
											        <td>Arta</td>
											        <td>2025-02-05 12:14:21.000</td>
											        <td>3,2</td>
											        <td>1,63</td>
											    </tr>
											    <tr>
											        <td>Chalkida</td>
											        <td>2025-01-30 15:55:28.000</td>
											        <td>4,4</td>
											        <td>1,54</td>
											    </tr>
											    <tr>
											        <td>Chania</td>
											        <td>2025-01-03 11:58:10.000</td>
											        <td>4</td>
											        <td>2,47</td>
											    </tr>
											    <tr>
											        <td>Drama</td>
											        <td>2025-01-17 19:24:57.000</td>
											        <td>3,4</td>
											        <td>1,71</td>
											    </tr>
											    <tr>
											        <td>Ioannina</td>
											        <td>2025-01-29 23:50:19.000</td>
											        <td>3,2</td>
											        <td>1,69</td>
											    </tr>
											    <tr>
											        <td>Kariai</td>
											        <td>2025-02-15 16:11:48.000</td>
											        <td>4,7</td>
											        <td>1,86</td>
											    </tr>
											    <tr>
											        <td>Lamia</td>
											        <td>2025-01-14 22:35:09.000</td>
											        <td>3,1</td>
											        <td>1,55</td>
											    </tr>
											    <tr>
											        <td>Mitilini</td>
											        <td>2025-01-21 20:38:43.000</td>
											        <td>5,1</td>
											        <td>2,16</td>
											    </tr>
											    <tr>
											        <td>Patras</td>
											        <td>2025-02-07 04:24:25.000</td>
											        <td>4</td>
											        <td>1,25</td>
											    </tr>
											    <tr>
											        <td>Poliyiros</td>
											        <td>2025-01-17 20:17:28.000</td>
											        <td>3,3</td>
											        <td>1,67</td>
											    </tr>
											    <tr>
											        <td>Pyrgos</td>
											        <td>2025-01-06 09:47:56.000</td>
											        <td>4,6</td>
											        <td>1,74</td>
											    </tr>
											    <tr>
											        <td>Skyros</td>
											        <td>2025-02-03 08:01:02.000</td>
											        <td>4,5</td>
											        <td>2,1</td>
											    </tr>
											    <tr>
											        <td>Thessaloniki</td>
											        <td>2025-01-19 16:10:39.000</td>
											        <td>2,9</td>
											        <td>1,29</td>
											    </tr>
											    <tr>
											        <td>Thira</td>
											        <td>2025-02-05 19:09:38.000</td>
											        <td>5,2</td>
											        <td>2,87</td>
											    </tr>
											    <tr>
											        <td>Zakynthos</td>
											        <td>2025-01-31 07:36:03.000</td>
											        <td>4,1</td>
											        <td>2,05</td>
											    </tr>
											</table>
											</div>								
									     
										<!--<li><p>Estimated the probability of a future earthquake >6.0 per region based on historical data.</p></li>
											    
												<li><p> Highlighted regions with a higher likelihood of strong earthquakes.</p></li>-->											
												
											
									<h3>The Outcome</h3>
									<p> This project demonstrates how SQL can be used to analyze and extract insights from earthquake activity data. By leveraging SQL queries, we can uncover trends, detect patterns, and perform in-depth analysis to better understand earthquake behavior in Greece.</p>
								<ul class="actions">
									    <!-- <li><a href="https://github.com/maryagrapidi/Earthquake Monitoring and Analysis in Greece_SQL_Project" class="button next">See Code Here</a></li>-->
								     </ul>
								</div>
							</section>

					</div>			

	<!-- Footer -->
					<footer id="footer">
						<div class="inner">
							<ul class="icons">
								 <li><a href="https://github.com/maryagrapidi" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
								 <li><a href="https://www.linkedin.com/in/maria-agrapidi-business-intelligence" class="icon brands alt fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
								 <li><a href="mailto:maryagrapidi@gmail.com" class="icon solid alt fa-envelope"><span class="label">Email</span></a></li>
							</ul>
							<ul class="copyright">
							<li>&copy; Mary Agrapidi</li>
						    <li>Design: <a href="https://html5up.net">HTML5 UP</a></li>
                        </ul>
					</div>
				</footer>
			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			
<script>
    function toggleQuery(id) {
        var queryDiv = document.getElementById(id);
        if (queryDiv.style.display === "none" || queryDiv.style.display === "") {
            queryDiv.style.display = "block";
        } else {
            queryDiv.style.display = "none";
        }
    }
</script>	

 <script>
        // JavaScript κώδικας εδώ
        const menu = document.getElementById('menu');
        const sticky = menu.offsetTop;

        window.onscroll = function() {
            if (window.pageYOffset > sticky) {
                menu.classList.add('fixed');
            } else {
                menu.classList.remove('fixed');
            }
        };
    </script>

    <script>
        const scrollBtn = document.getElementById("scrollTopBtn");

        // Δείξε το κουμπί όταν γίνεται scroll κάτω
        window.onscroll = function() {
            if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                scrollBtn.classList.add("show");
            } else {
                scrollBtn.classList.remove("show");
            }
        };

        // Smooth scroll στην κορυφή
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: "smooth" });
        }
    </script>
												    
	</body>
</html>
